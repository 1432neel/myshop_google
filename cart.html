<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cart - MyShop</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Toastify -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
</head>

<body class="bg-gray-50 min-h-screen flex flex-col">
  <!-- ‚úÖ Unified Navbar -->
<nav class="sticky top-0 z-10 w-full bg-white shadow-md">
  <div class="max-w-7xl mx-auto flex flex-wrap items-center justify-between px-4 sm:px-6 py-3">
    <!-- Left -->
    <div class="flex items-center gap-4 sm:gap-6">
      <a href="index.html" class="text-2xl font-bold text-blue-600">MyShop</a>
      <a href="index.html" class="text-gray-700 hover:text-blue-600 transition text-sm sm:text-base">Home</a>
    </div>

    <!-- Right -->
    <div class="flex items-center gap-4 mt-3 sm:mt-0">
      <a href="wishlist.html" class="flex items-center gap-1 text-gray-700 hover:text-pink-600 transition text-sm sm:text-base">
        <span class="text-lg sm:text-xl">‚ù§Ô∏è</span>
        <span id="wishCount">0</span>
      </a>

      <a href="cart.html" class="flex items-center gap-1 text-gray-700 hover:text-blue-600 transition text-sm sm:text-base">
        <span class="text-lg sm:text-xl">üõí</span>
        <span id="cartCount">0</span>
      </a>

      <!-- Login/Profile -->
      <div id="userSection" class="min-w-[160px] sm:min-w-[180px] text-sm sm:text-base"></div>
    </div>
  </div>
</nav>



  <main class="flex-grow container mx-auto px-4 py-8">
    <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">üõí Your Shopping Cart</h2>

    <div id="cartContainer" class="space-y-4"></div>

    <!-- Total -->
    <div id="cartSummary" class="mt-10 hidden">
      <div class="flex flex-col md:flex-row justify-between items-center bg-white shadow-sm rounded-lg p-4">
        <div class="text-lg font-semibold text-gray-800">
          Total: <span id="totalAmount" class="text-blue-600">‚Çπ0</span>
        </div>
        <div class="flex gap-3 mt-4 md:mt-0">
          <button onclick="clearCart()" class="border border-red-500 text-red-600 px-4 py-2 rounded hover:bg-red-50 transition">
            Clear Cart
          </button>
          <button class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition">
            Proceed to Checkout
          </button>
        </div>
      </div>
    </div>
  </main>

  <footer class="bg-white text-center py-4 border-t text-gray-500">
    ¬© <span id="year"></span> MyShop. All rights reserved.
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<script src="js/toast.js"></script>
<script src="js/shared.js"></script>
<script src="js/auth.js"></script>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    function showToast(msg, color = "#2563eb"){
      Toastify({text: msg, duration: 2000, gravity:"top", position:"right", backgroundColor: color}).showToast();
    }

    function renderCart(){
      const cart = loadData('cart');
      const container = document.getElementById('cartContainer');
      const summary = document.getElementById('cartSummary');
      const totalElem = document.getElementById('totalAmount');

      if(!cart.length){
        container.innerHTML = `
          <div class="text-center text-gray-500 mt-10">
            <p>Your cart is empty.</p>
            <a href="index.html" class="text-blue-600 hover:underline">Continue Shopping</a>
          </div>`;
        summary.classList.add('hidden');
        return;
      }

      container.innerHTML = cart.map(i=>`
        <div class="bg-white shadow-sm hover:shadow-md transition p-4 rounded-lg flex flex-col sm:flex-row justify-between items-center">
          <div class="flex items-center gap-4 w-full sm:w-auto">
            <img src="${i.img}" alt="${i.name}" class="w-24 h-24 object-contain rounded-md border bg-white p-1">

            <div>
              <div class="font-semibold text-gray-800">${i.name}</div>
              <div class="text-sm text-gray-500">‚Çπ${i.price}</div>
            </div>
          </div>

          <div class="flex items-center gap-3 mt-4 sm:mt-0">
            <button onclick="changeQty(${i.id},-1)" class="border px-3 py-1 rounded hover:bg-gray-100">-</button>
            <span class="w-6 text-center">${i.qty}</span>
            <button onclick="changeQty(${i.id},1)" class="border px-3 py-1 rounded hover:bg-gray-100">+</button>
            <button onclick="removeItem(${i.id})" class="text-red-600 ml-3 hover:underline">Remove</button>
          </div>
        </div>
      `).join('');

      const total = cart.reduce((sum,i)=>sum+i.price*i.qty,0);
      totalElem.textContent = `‚Çπ${total}`;
      summary.classList.remove('hidden');
    }

    function changeQty(id, delta) {
  const cart = loadData('cart');
  const item = cart.find(x => x.id === id);
  if (!item) return;
  item.qty = Math.max(1, item.qty + delta); // ‚úÖ ensure it never goes below 1
  saveData('cart', cart);
  renderCart();
  updateCounts(); // ‚úÖ also update header
}


    function removeItem(id){
  let cart = loadData('cart').filter(i => i.id !== id);
  saveData('cart', cart);
  showToast("Removed from cart", "#dc2626");
  renderCart();
  updateCounts(); // <-- Add here
}


    function clearCart(){
  localStorage.removeItem("cart");
  showToast("Cart cleared", "#dc2626");
  renderCart();
  updateCounts(); // <-- Add here
}


    renderCart();
  </script>

<script>
  // Initialize header counts when page loads
  document.addEventListener("DOMContentLoaded", updateCounts);
</script>
  
</body>
</html>
